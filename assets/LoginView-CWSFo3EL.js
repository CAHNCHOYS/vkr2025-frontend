import{d as D,j as r,s as M,c as $,e as o,a as _,w as t,r as a,f as b,k as C,t as I,g as V,q as P,b as u,y as G,n as H,z as J,i as g,A as K,u as O,_ as Q}from"./index-BCLyBTkh.js";import{u as W,_ as X}from"./useFormValidation-D9igFeM7.js";const Y={class:"d-flex i justify-center align-center h-screen overflow-auto"},Z={class:"text-h6"},ee=D({__name:"LoginView",setup(te){const c=r(!1),i=r({email:"",password:""}),d=r(!1),m=r(""),w=r(!1),p=r(!1),{form:f,minLength:k,email:q,required:S}=W(),s=H(),L=J(),F=async()=>{var x;if(f.value)try{p.value=!0;const{teacher:e,token:l}=await K.login(i.value);O().setCurrentTeacher(e,l),w.value=!0,setTimeout(()=>{L.push({name:s.query.redirectedFrom?s.query.redirectedFrom:"home",params:s.params})},3e3)}catch(e){const l=e;console.log(l),m.value=((x=l.response)==null?void 0:x.data.error)||"Произошла ошибка при авторизации повторите попытку позже!",d.value=!0,setTimeout(()=>d.value=!1,3e3)}finally{p.value=!1}};return M(()=>s.query.isLoginRequired,()=>{s.query.isLoginRequired&&(d.value=!0,m.value=`Для доступа к странице ${s.query.redirectedFrom} необходимо авторизироваться`,setTimeout(()=>{d.value=!1,m.value=""},3e3))},{immediate:!0}),(x,e)=>{const l=a("VAlert"),y=a("VScaleTransition"),A=a("VCardTitle"),T=a("VTextField"),v=a("VCol"),h=a("VBtn"),R=a("v-btn"),B=a("v-alert"),N=a("v-col"),E=a("VRow"),U=a("VForm"),j=a("VCardActions"),z=a("VCard");return g(),$("div",Y,[o(y,null,{default:t(()=>[d.value?(g(),b(l,{key:0,type:"error",variant:"flat",class:"top-0 card left-0",position:"fixed","max-width":"380"},{default:t(()=>[_("p",Z,I(m.value),1)]),_:1})):C("",!0)]),_:1}),o(y,null,{default:t(()=>[w.value?(g(),b(l,{key:0,type:"success",variant:"flat",class:"top-0 card left-0",position:"fixed","max-width":"380"},{default:t(()=>e[4]||(e[4]=[_("p",{class:"text-h6"}," Авторизация прошла успешно, вы будете переведенны на главную страницу! ",-1)])),_:1})):C("",!0)]),_:1}),o(z,{"max-width":"600",class:"pa-8 flex-grow-1 rounded-0",variant:"flat",elevation:"15",style:{"z-index":"100"}},{default:t(()=>[o(A,{class:"text-h4 text-center font-weight-bold px-0 py-0 text-wrap mb-5"},{default:t(()=>e[5]||(e[5]=[V(" Авторизация ")])),_:1}),o(j,null,{default:t(()=>[o(U,{modelValue:u(f),"onUpdate:modelValue":e[3]||(e[3]=n=>G(f)?f.value=n:null),onSubmit:P(F,["prevent"]),class:"w-100"},{default:t(()=>[o(E,{"no-gutters":""},{default:t(()=>[o(v,{cols:"12",class:"mb-4"},{default:t(()=>[o(T,{label:"Почта",modelValue:i.value.email,"onUpdate:modelValue":e[0]||(e[0]=n=>i.value.email=n),rules:[u(S),u(k),u(q)]},null,8,["modelValue","rules"])]),_:1}),o(v,{cols:"12",class:"mb-4"},{default:t(()=>[o(T,{label:"Пароль",modelValue:i.value.password,"onUpdate:modelValue":e[1]||(e[1]=n=>i.value.password=n),type:c.value?"text":"password","append-icon":c.value?"mdi-eye":"mdi-eye-off","onClick:append":e[2]||(e[2]=n=>c.value=!c.value),rules:[u(S),u(k)]},null,8,["modelValue","type","append-icon","rules"])]),_:1}),o(v,{cols:"12",class:"mb-2"},{default:t(()=>[o(h,{color:"green",variant:"flat",block:"",height:"50",type:"submit",loading:p.value,disabled:p.value},{default:t(()=>e[6]||(e[6]=[V("Войти")])),_:1},8,["loading","disabled"])]),_:1}),w.value?(g(),b(v,{key:0,cols:"12",class:"mb-2"},{default:t(()=>[o(h,{color:"orange",class:"text-white",variant:"flat",block:"",height:"50",to:"/"},{default:t(()=>e[7]||(e[7]=[V("На главную страницу")])),_:1})]),_:1})):C("",!0),o(N,{cols:"12"},{default:t(()=>[o(B,{type:"info"},{default:t(()=>[e[9]||(e[9]=_("p",{class:"text-h6 mb-4"},"Еще нет аккаунта?",-1)),o(R,{block:"",to:"/register",variant:"outlined",color:"white"},{default:t(()=>e[8]||(e[8]=[V("К регистрации")])),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1}),e[10]||(e[10]=_("img",{class:"bg",src:X,alt:"Фоновая картинка"},null,-1))])}}}),le=Q(ee,[["__scopeId","data-v-1632d05b"]]);export{le as default};
