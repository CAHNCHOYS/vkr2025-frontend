import{u as O}from"./subjects-CRNKqVmv.js";import{d as $,j as y,f as v,w as o,r as l,e as n,g as k,q as P,i as c,s as T,c as j,a as r,t as C,p as Q,l as R,k as D,m as E,F as N,h as G,u as H,o as I,b as f}from"./index-BoFnWDe-.js";const J=$({__name:"AddDialog",props:{isActive:{type:Boolean},isSubjectAdding:{type:Boolean}},emits:["closeDialog","addSubject"],setup(w,{emit:_}){const s=_,a=y(""),m=async()=>{console.log("submiting form"),s("addSubject",a.value),a.value=""};return(i,e)=>{const t=l("v-card-title"),d=l("v-text-field"),x=l("v-col"),g=l("v-btn"),h=l("v-row"),p=l("v-form"),u=l("v-card-text"),A=l("v-card"),V=l("v-dialog");return c(),v(V,{"model-value":i.isActive,"onUpdate:modelValue":e[2]||(e[2]=S=>i.$emit("closeDialog")),width:"auto"},{default:o(()=>[n(A,{"min-width":"500",elevation:"5"},{default:o(()=>[n(t,{class:"text-h4 text-center mb-3"},{default:o(()=>e[3]||(e[3]=[k("Добавление предмета")])),_:1}),n(u,null,{default:o(()=>[n(p,{class:"w-100",onSubmit:P(m,["prevent"])},{default:o(()=>[n(h,null,{default:o(()=>[n(x,{cols:"12"},{default:o(()=>[n(d,{modelValue:a.value,"onUpdate:modelValue":e[0]||(e[0]=S=>a.value=S),placeholder:"Название предмета",clearable:"",class:"w-100"},null,8,["modelValue"])]),_:1}),n(x,{cols:"12"},{default:o(()=>[n(g,{variant:"flat",color:"green",type:"submit",class:"mr-4",loading:i.isSubjectAdding},{default:o(()=>e[4]||(e[4]=[k("Добавить")])),_:1},8,["loading"]),n(g,{variant:"flat",color:"red",onClick:e[1]||(e[1]=S=>i.$emit("closeDialog"))},{default:o(()=>e[5]||(e[5]=[k("Закрыть")])),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["model-value"])}}}),K={class:"pr-10"},W={class:"w-100"},X=$({__name:"SubjectTableRow",props:{subject:{},cancelSelection:{type:Boolean}},emits:["selectRow"],setup(w,{emit:_}){const s=w,a=y(!1),m=_;return T(a,()=>{m("selectRow",s.subject.id,a.value)}),T(()=>s.cancelSelection,()=>{s.cancelSelection&&(a.value=!1)}),(i,e)=>{const t=l("v-checkbox");return c(),j("tr",{style:{cursor:"pointer"},onClick:e[1]||(e[1]=d=>a.value=!a.value),class:Q(a.value?"bg-cyan-lighten-5":"")},[r("td",K,[n(t,{modelValue:a.value,"onUpdate:modelValue":e[0]||(e[0]=d=>a.value=d),color:"grey"},null,8,["modelValue"])]),r("td",W,C(i.subject.name),1)],2)}}}),Y={key:0},Z={key:1},ee={key:2},te=$({__name:"SubjectsTable",props:{subjects:{},isSubjectsDeleting:{type:Boolean}},emits:["openDialog","deleteSubjects"],setup(w,{emit:_}){const s=w,a=_,m=y(""),i=y([]),e=y(!1),t=R(()=>i.value.length),d=R(()=>s.subjects.filter(p=>p.name.includes(m.value))),x=()=>{e.value=!0,i.value=[]},g=()=>{a("deleteSubjects",i.value),i.value=[]},h=(p,u)=>{e.value=!1,u?i.value.push(p):i.value=i.value.filter(A=>A!==p)};return(p,u)=>{const A=l("v-text-field"),V=l("v-sheet"),S=l("v-btn"),B=l("v-toolbar-title"),L=l("v-tooltip"),U=l("v-badge"),F=l("v-toolbar"),M=l("v-table"),q=l("v-card-text"),z=l("v-card");return c(),v(z,{elevation:"8",rounded:"0",class:"pa-0"},{default:o(()=>[n(q,{class:"pa-0"},{default:o(()=>[n(V,{class:"pa-5"},{default:o(()=>[n(A,{modelValue:m.value,"onUpdate:modelValue":u[0]||(u[0]=b=>m.value=b),placeholder:"Поиск предмета"},null,8,["modelValue"])]),_:1}),n(F,{height:"70",color:t.value?"brown":"blue-grey",class:"px-3"},{default:o(()=>[t.value?(c(),v(S,{key:0,onClick:x,icon:"mdi-close"})):D("",!0),t.value?(c(),v(B,{key:2},{default:o(()=>[k(" Всего выбрано : "+C(t.value),1)]),_:1})):(c(),v(B,{key:1},{default:o(()=>u[2]||(u[2]=[k(" Ваши предметы ")])),_:1})),n(L,{text:"Добавить предмет",location:"bottom","content-class":"bg-green text-white"},{activator:o(({props:b})=>[n(S,E({icon:"mdi-plus",onClick:u[1]||(u[1]=ne=>p.$emit("openDialog"))},b),null,16)]),_:1}),n(L,{text:"Удалить выделенные",location:"bottom center","content-class":"bg-red text-white"},{activator:o(({props:b})=>[t.value?(c(),v(U,{key:0,content:t.value,color:"red","offset-x":"10","offset-y":"10"},{default:o(()=>[n(S,E({onClick:g,loading:p.isSubjectsDeleting,icon:"mdi-trash-can"},b),null,16,["loading"])]),_:2},1032,["content"])):D("",!0)]),_:1})]),_:1},8,["color"]),n(M,{density:"comfortable"},{default:o(()=>[d.value.length?(c(),j("thead",Y,u[3]||(u[3]=[r("tr",null,[r("th",{class:"text-h6 text-left text-black"}),r("th",{class:"text-left text-h6 text-black"},"Название предмета")],-1)]))):D("",!0),d.value.length?(c(),j("tbody",Z,[(c(!0),j(N,null,G(d.value,b=>(c(),v(X,{key:b.id,subject:b,"cancel-selection":e.value,onSelectRow:h},null,8,["subject","cancel-selection"]))),128))])):(c(),j("tbody",ee,u[4]||(u[4]=[r("tr",null,[r("th",{class:"text-subtitle-1 text-left text-red pl-8"},"Предметов не найдено("),r("th",{class:"text-left text-h6 text-black"})],-1)])))]),_:1})]),_:1})]),_:1})}}}),oe={key:1},le={class:"text-h6"},ce=$({__name:"TeacherSubjects",setup(w){const _=y(!1),s=O(),a=H(),m=async e=>{await s.addSubject(a.currentTeacher.id,e)},i=async e=>{s.isActionLoading=!0;for(const t of e)await s.deleteSubject(t);s.isActionLoading=!1};return I(async()=>{await s.loadAllSubjects(a.currentTeacher.id)}),(e,t)=>{const d=l("v-progress-linear"),x=l("v-alert"),g=l("v-snackbar");return c(),j(N,null,[t[4]||(t[4]=r("h2",{class:"text-h2 mb-7"},"Мои предметы",-1)),f(s).isActionLoading?(c(),v(d,{key:0,height:"10",color:"indigo",indeterminate:""})):(c(),j("div",oe,[f(s).isSubjectLoadError?(c(),v(x,{key:0,type:"error",variant:"flat",class:"w-100"},{default:o(()=>t[2]||(t[2]=[k("Ошибка при загрузке предметов, повторите попытку позже!")])),_:1})):(c(),v(te,{key:1,subjects:f(s).teacherSubjects,onOpenDialog:t[0]||(t[0]=h=>_.value=!0),onDeleteSubjects:i,"is-subjects-deleting":f(s).isActionLoading},null,8,["subjects","is-subjects-deleting"]))])),n(J,{"is-active":_.value,"is-subject-adding":f(s).isActionLoading,onCloseDialog:t[1]||(t[1]=h=>_.value=!1),onAddSubject:m},null,8,["is-active","is-subject-adding"]),n(g,{"model-value":f(s).isActionSuccess,location:"top",color:"green"},{default:o(()=>t[3]||(t[3]=[r("div",{class:"text-h6"},"Прдемет успешно был добавлен!",-1)])),_:1},8,["model-value"]),n(g,{"model-value":f(s).isSubjectActionError,location:"top",color:"red"},{default:o(()=>[r("div",le,"Ошибка: "+C(f(s).subjectActionErrorMessage),1)]),_:1},8,["model-value"])],64)}}});export{ce as default};
