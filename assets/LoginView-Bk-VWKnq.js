import{d as D,j as i,n as M,s as $,c as I,e as o,a as V,w as t,r as a,f as C,k,t as Q,g,q as G,b as d,y as H,z as J,i as y,A as K,u as O,_ as W}from"./index-CvDodZGt.js";import{u as X,_ as Y}from"./useFormValidation-CUkRqzYQ.js";function Z(c){switch(c){case"teacher-subjects":return"предметов учителя";case"my-tests":return"тестов учителя";case"create-test":return"создания теста";case"test-result":return"результатов прохождения теста";case"edit-test":return"редактирования теста";default:return""}}function ee(c){const l={};for(const s in c)s!="redirectedFrom"&&s!="isLoginRequired"&&(l[s]=c[s]);return l}const te={class:"d-flex i justify-center align-center h-screen overflow-auto"},oe={class:"text-h6"},ae=D({__name:"LoginView",setup(c){const l=i(!1),s=i({email:"",password:""}),m=i(!1),f=i(""),w=i(!1),p=i(!1),{form:v,minLength:h,email:q,required:F}=X(),r=M(),L=J();console.log(r.query);const A=async()=>{var x;if(v.value)try{p.value=!0;const{teacher:e,token:n}=await K.login(s.value);O().setCurrentTeacher(e,n),w.value=!0,setTimeout(()=>{L.push({name:r.query.redirectedFrom?r.query.redirectedFrom:"home",params:ee(r.query)})},3e3)}catch(e){const n=e;console.log(n),f.value=((x=n.response)==null?void 0:x.data.error)||"Произошла ошибка при авторизации повторите попытку позже!",m.value=!0,setTimeout(()=>m.value=!1,3e3)}finally{p.value=!1}};return $(()=>r.query.redirectedFrom,()=>{r.query.redirectedFrom&&(m.value=!0,f.value=`Для доступа к странице ${Z(r.query.redirectedFrom)} необходимо авторизироваться`,setTimeout(()=>{m.value=!1,f.value=""},3e3))},{immediate:!0}),(x,e)=>{const n=a("VAlert"),b=a("VScaleTransition"),B=a("VCardTitle"),S=a("VTextField"),_=a("VCol"),T=a("VBtn"),R=a("v-btn"),N=a("v-alert"),z=a("v-col"),E=a("VRow"),P=a("VForm"),U=a("VCardActions"),j=a("VCard");return y(),I("div",te,[o(b,null,{default:t(()=>[m.value?(y(),C(n,{key:0,type:"error",variant:"flat",class:"top-0 card left-0",position:"fixed","max-width":"380",style:{"z-index":"999"}},{default:t(()=>[V("p",oe,Q(f.value),1)]),_:1})):k("",!0)]),_:1}),o(b,null,{default:t(()=>[w.value?(y(),C(n,{key:0,type:"success",variant:"flat",class:"top-0 card left-0",position:"fixed","max-width":"380",style:{"z-index":"999"}},{default:t(()=>e[4]||(e[4]=[V("p",{class:"text-h6"}," Авторизация прошла успешно, вы будете переведенны на следующую страницу! ",-1)])),_:1})):k("",!0)]),_:1}),o(j,{"max-width":"600",class:"pa-8 flex-grow-1 rounded-0",variant:"flat",elevation:"15",style:{"z-index":"100"}},{default:t(()=>[o(B,{class:"text-h4 text-center font-weight-bold px-0 py-0 text-wrap mb-5"},{default:t(()=>e[5]||(e[5]=[g(" Авторизация ")])),_:1}),o(U,null,{default:t(()=>[o(P,{modelValue:d(v),"onUpdate:modelValue":e[3]||(e[3]=u=>H(v)?v.value=u:null),onSubmit:G(A,["prevent"]),class:"w-100"},{default:t(()=>[o(E,{"no-gutters":""},{default:t(()=>[o(_,{cols:"12",class:"mb-4"},{default:t(()=>[o(S,{label:"Почта",modelValue:s.value.email,"onUpdate:modelValue":e[0]||(e[0]=u=>s.value.email=u),rules:[d(F),d(h),d(q)]},null,8,["modelValue","rules"])]),_:1}),o(_,{cols:"12",class:"mb-4"},{default:t(()=>[o(S,{label:"Пароль",modelValue:s.value.password,"onUpdate:modelValue":e[1]||(e[1]=u=>s.value.password=u),type:l.value?"text":"password","append-icon":l.value?"mdi-eye":"mdi-eye-off","onClick:append":e[2]||(e[2]=u=>l.value=!l.value),rules:[d(F),d(h)]},null,8,["modelValue","type","append-icon","rules"])]),_:1}),o(_,{cols:"12",class:"mb-2"},{default:t(()=>[o(T,{color:"green",variant:"flat",block:"",height:"50",type:"submit",loading:p.value,disabled:p.value},{default:t(()=>e[6]||(e[6]=[g("Войти")])),_:1},8,["loading","disabled"])]),_:1}),w.value?(y(),C(_,{key:0,cols:"12",class:"mb-2"},{default:t(()=>[o(T,{color:"orange",class:"text-white",variant:"flat",block:"",height:"50",to:"/"},{default:t(()=>e[7]||(e[7]=[g("На главную страницу")])),_:1})]),_:1})):k("",!0),o(z,{cols:"12"},{default:t(()=>[o(N,{type:"info"},{default:t(()=>[e[9]||(e[9]=V("p",{class:"text-h6 mb-4"},"Еще нет аккаунта?",-1)),o(R,{block:"",to:"/register",variant:"outlined",color:"white"},{default:t(()=>e[8]||(e[8]=[g("К регистрации")])),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1}),e[10]||(e[10]=V("img",{class:"bg",src:Y,alt:"Фоновая картинка"},null,-1))])}}}),re=W(ae,[["__scopeId","data-v-4891aff8"]]);export{re as default};
