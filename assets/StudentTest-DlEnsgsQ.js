import{d as S,f as _,r as i,w as c,e as r,g as y,i as o,c as v,F as k,h as q,j as f,l as x,a as C,k as $,t as L,n as I,p as D,o as X,b as V,m as G,_ as H}from"./index-AS5MfRMp.js";import{_ as J}from"./Question.vue_vue_type_script_setup_true_lang-DFvmchCP.js";import{u as R}from"./tests-DKUGa9TU.js";import"./testService-Le-zT_Pc.js";const K=""+new URL("bg3--tNjdXNB.jpg",import.meta.url).href,U=S({__name:"QuestionsNav",props:{isFirst:{type:Boolean},isLast:{type:Boolean}},emits:["changeQuestion"],setup(b,{emit:u}){const t=u;return(s,e)=>{const d=i("v-btn"),l=i("v-col"),p=i("v-spacer"),m=i("v-row");return o(),_(m,null,{default:c(()=>[r(l,{cols:"auto"},{default:c(()=>[r(d,{icon:"mdi-arrow-left",onClick:e[0]||(e[0]=g=>t("changeQuestion",-1)),disabled:s.isFirst,color:"red"},null,8,["disabled"])]),_:1}),r(p),s.isLast?(o(),_(l,{key:1,cols:"auto"},{default:c(()=>[r(d,{onClick:e[2]||(e[2]=g=>t("changeQuestion",1)),variant:"outlined",color:"red"},{default:c(()=>e[3]||(e[3]=[y("Закончить тест")])),_:1})]),_:1})):(o(),_(l,{key:0,cols:"auto"},{default:c(()=>[r(d,{icon:"mdi-arrow-right",onClick:e[1]||(e[1]=g=>t("changeQuestion",1)),color:"green"})]),_:1}))]),_:1})}}}),O=S({__name:"Single",props:{answers:{},isLast:{type:Boolean},currentAnswer:{},isFirst:{type:Boolean}},emits:["changeQuestion","updateStudentAnswer"],setup(b,{emit:u}){const t=u;return(s,e)=>{const d=i("v-radio"),l=i("v-radio-group");return o(),v(k,null,[r(l,{"model-value":s.currentAnswer,"onUpdate:modelValue":e[0]||(e[0]=p=>t("updateStudentAnswer",p)),inline:!1,class:"d-flex flex-column"},{default:c(()=>[(o(!0),v(k,null,q(s.answers,p=>(o(),_(d,{key:p,label:p,value:p},null,8,["label","value"]))),128))]),_:1},8,["model-value"]),r(U,{"is-first":s.isFirst,"is-last":s.isLast,onChangeQuestion:e[1]||(e[1]=p=>t("changeQuestion",p)),class:"mt-3 pl-4 pr-4"},null,8,["is-first","is-last"])],64)}}}),W=S({__name:"Multiply",props:{answers:{},isLast:{type:Boolean},isFirst:{type:Boolean},currentAnswer:{}},emits:["changeQuestion","updateStudentAnswer"],setup(b,{emit:u}){const t=u;return f([]),(s,e)=>{const d=i("v-checkbox");return o(),v(k,null,[(o(!0),v(k,null,q(s.answers,l=>(o(),_(d,{"model-value":s.currentAnswer,"onUpdate:modelValue":e[0]||(e[0]=p=>t("updateStudentAnswer",p)),key:l,value:l,label:l,"hide-details":""},null,8,["model-value","value","label"]))),128)),r(U,{"is-first":s.isFirst,"is-last":s.isLast,onChangeQuestion:e[1]||(e[1]=l=>t("changeQuestion",l)),class:"mt-3 pl-4 pr-4"},null,8,["is-first","is-last"])],64)}}}),Y=S({__name:"Text",props:{isLast:{type:Boolean},isFirst:{type:Boolean},currentAnswer:{}},emits:["changeQuestion","updateStudentAnswer"],setup(b,{emit:u}){const t=u;return f(""),(s,e)=>{const d=i("v-text-field");return o(),v(k,null,[r(d,{"model-value":s.currentAnswer,"onUpdate:modelValue":e[0]||(e[0]=l=>t("updateStudentAnswer",l)),label:"Ваш ответ"},null,8,["model-value"]),r(U,{"is-first":s.isFirst,"is-last":s.isLast,onChangeQuestion:e[1]||(e[1]=l=>t("changeQuestion",l)),class:"mt-3 pl-4 pr-4"},null,8,["is-first","is-last"])],64)}}}),Z={key:0,class:"border-thin pa-2"},ee={key:0},te={class:"text-h6 mb-4"},se={key:1},ne={class:"font-weight-bold"},oe={key:1},le=S({__name:"StudentTestPassing",props:{questions:{},studentName:{}},setup(b){const u=b,t=f(1),s=f(Array(u.questions.length).fill("")),e=f(Array(u.questions.length).fill(0)),d=x(()=>t.value===u.questions.length),l=x(()=>u.questions[t.value-1]),p=f(!1),m=R(),g=I(),A=n=>{Array.isArray(n)?s.value[t.value-1]=n.join("|"):s.value[t.value-1]=n},Q=n=>{d.value&&n===1?F():n===-1?t.value--:t.value++},F=async()=>{t.value=1,s.value.forEach((n,a)=>{const w=u.questions[a];switch(w.type){case"multiply":w.rightAnswer.split("").sort().join("")===n.slice(1).split("").sort().join("")&&(e.value[a]=w.weight);break;default:w.rightAnswer==n?e.value[a]=w.weight:e.value[a]=0}}),p.value=!0,await m.addTestResult(+g.params.testId,u.studentName,T.value,B.value)},T=x(()=>e.value.reduce((n,a)=>n+a)),B=x(()=>u.questions.reduce((n,a)=>n+a.weight,0)),N=n=>x(()=>{var a;return(a=s.value[n])!=null&&a.includes("|")?s.value[n].split("|"):s.value[n]}).value;return(n,a)=>{const w=i("v-pagination"),z=i("v-divider"),j=i("v-alert"),P=i("v-btn");return n.questions.length?(o(),v("div",Z,[p.value?(o(),v("div",se,[a[3]||(a[3]=C("h3",{class:"text-h6 mb-4 text-center"},"Результаты прохождения теста",-1)),(o(!0),v(k,null,q(n.questions,(h,M)=>{var E;return o(),v("div",{class:D([e.value[M]===0?"bg-red-lighten-4":"bg-light-green-lighten-4","mb-4 pa-2"])},[(o(),_(J,{key:h.id,text:h.text,answers:(E=h.answers)==null?void 0:E.split("|"),type:h.type,"user-answer":N(M),"is-editable":!1},null,8,["text","answers","type","user-answer"]))],2)}),256)),r(z,{thickness:"4",class:"mb-4"}),r(j,{type:"info",class:"text-h6 mb-4"},{default:c(()=>[a[1]||(a[1]=y(" Вы набрали ")),C("span",ne,L(T.value),1),y(" баллов из "+L(B.value),1)]),_:1}),r(P,{to:"/",block:"",color:"green"},{default:c(()=>a[2]||(a[2]=[y("На главную страницу")])),_:1})])):(o(),v("div",ee,[r(w,{modelValue:t.value,"onUpdate:modelValue":a[0]||(a[0]=h=>t.value=h),length:n.questions.length,rounded:"","active-color":"green-darken-4"},null,8,["modelValue","length"]),C("h3",te," Вопрос № "+L(t.value)+": "+L(l.value.text),1),l.value.type==="text"?(o(),_(Y,{key:0,"is-first":t.value===1,"is-last":d.value,"current-answer":s.value[t.value-1],onUpdateStudentAnswer:A,onChangeQuestion:Q},null,8,["is-first","is-last","current-answer"])):$("",!0),l.value.type==="single"?(o(),_(O,{key:1,"is-first":t.value===1,"is-last":d.value,answers:l.value.answers.split("|"),"current-answer":s.value[t.value-1],onUpdateStudentAnswer:A,onChangeQuestion:Q},null,8,["is-first","is-last","answers","current-answer"])):$("",!0),l.value.type==="multiply"?(o(),_(W,{key:2,"is-first":t.value===1,"is-last":d.value,answers:l.value.answers.split("|"),"current-answer":s.value[t.value-1].split("|"),onUpdateStudentAnswer:A,onChangeQuestion:Q},null,8,["is-first","is-last","answers","current-answer"])):$("",!0)]))])):(o(),v("div",oe,[r(j,{type:"info",class:"text-h6"},{default:c(()=>a[4]||(a[4]=[C("p",null," Вопросов не найдено, возможно, тест удален или в нем попросту отсутствуют вопрсы ",-1)])),_:1})]))}}}),ae={class:"d-flex justify-center align-center h-100 pa-8 overflow-auto"},re={key:0},ue=S({__name:"StudentTest",setup(b){const u=R(),t=I(),s=f(""),e=f(!1),d=()=>{navigator.clipboard.writeText(window.location.href)},l=()=>{console.log("Trying"),!(s.value.length<5)&&(e.value=!0)};return X(async()=>{await u.loadSingleTest(+t.params.testId)}),(p,m)=>{const g=i("v-btn"),A=i("v-tooltip"),Q=i("v-card-title"),F=i("v-text-field"),T=i("v-card-text"),B=i("v-alert"),N=i("v-card");return o(),v("div",ae,[r(N,{"max-width":"800",class:"pa-8 flex-grow-1 rounded-0 overflow-auto",variant:"flat",elevation:"15",style:{"z-index":"100"},loading:V(u).isTestsLoading},{default:c(()=>[r(Q,{class:"mb-8 text-h5 d-flex align-center"},{default:c(()=>[r(A,{text:"Копировать ссылку на тест",location:"bottom center","content-class":"bg-blue-grey"},{activator:c(({props:n})=>[r(g,G({onClick:d},n,{icon:"mdi-link-box-outline",color:"blue",class:"mr-4"}),null,16)]),_:1}),y(" "+L(V(u).editingTestName),1)]),_:1}),V(u).isTestsLoadError?(o(),_(T,{key:1},{default:c(()=>[r(B,{type:"error"},{default:c(()=>m[2]||(m[2]=[y(" Ошибка при загрузки теста, повторите попытку ! ")])),_:1})]),_:1})):(o(),_(T,{key:0},{default:c(()=>[e.value?(o(),_(le,{key:1,questions:V(u).getSortedTestQuestions,"student-name":s.value},null,8,["questions","student-name"])):(o(),v("div",re,[r(F,{modelValue:s.value,"onUpdate:modelValue":m[0]||(m[0]=n=>s.value=n),label:"Введите ФИО",class:"mb-4"},null,8,["modelValue"]),r(g,{height:"50",color:"green",onClick:l},{default:c(()=>m[1]||(m[1]=[y("Начать тест")])),_:1})]))]),_:1}))]),_:1},8,["loading"]),m[3]||(m[3]=C("img",{class:"bg",src:K,alt:"Фоновая картинка"},null,-1))])}}}),ve=H(ue,[["__scopeId","data-v-3c2cd00b"]]);export{ve as default};
